<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>≈ûekerKerim Platinum | Next-Gen Security Exam</title>
<meta name="theme-color" content="#0f172a">
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700;900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
    :root {
        --bg-body: #0f172a;
        --card-bg: rgba(30, 41, 59, 0.6);
        --glass-border: rgba(255, 255, 255, 0.08);
        --primary: #06b6d4; /* Cyan */
        --primary-glow: rgba(6, 182, 212, 0.5);
        --secondary: #8b5cf6; /* Violet */
        --success: #10b981;
        --danger: #ef4444;
        --text: #f8fafc;
        --text-dim: #94a3b8;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }
    
    body {
        margin: 0; padding: 0;
        font-family: 'Outfit', sans-serif;
        background: var(--bg-body);
        color: var(--text);
        height: 100vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
    }

    /* --- BACKGROUND FX --- */
    .ambient-light {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
        background: radial-gradient(circle at 10% 10%, rgba(6, 182, 212, 0.15), transparent 40%),
                    radial-gradient(circle at 90% 90%, rgba(139, 92, 246, 0.15), transparent 40%);
        animation: pulseLight 10s infinite alternate;
    }
    @keyframes pulseLight { 0% { opacity: 0.5; } 100% { opacity: 1; } }

    /* --- LAYOUT --- */
    .app-viewport {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
        padding-bottom: 90px; /* Space for navbar */
        max-width: 600px;
        margin: 0 auto;
        width: 100%;
        position: relative;
    }

    .hidden { display: none !important; }
    .fade-in { animation: fadeIn 0.4s ease-out; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* --- HEADER --- */
    header {
        display: flex; justify-content: space-between; align-items: center;
        margin-bottom: 25px; padding-top: 10px;
    }
    .brand h1 { margin: 0; font-size: 1.5rem; font-weight: 900; letter-spacing: -1px; background: linear-gradient(to right, #fff, #94a3b8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .brand span { font-size: 0.7rem; color: var(--primary); font-weight: 700; letter-spacing: 2px; text-transform: uppercase; }
    
    .user-pill {
        background: rgba(255,255,255,0.05); padding: 5px 12px; border-radius: 20px;
        font-size: 0.8rem; border: 1px solid var(--glass-border); display: flex; align-items: center; gap: 8px;
    }

    /* --- CARDS --- */
    .card {
        background: var(--card-bg);
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
        border: 1px solid var(--glass-border);
        border-radius: 24px;
        padding: 24px;
        margin-bottom: 20px;
        box-shadow: 0 10px 40px -10px rgba(0,0,0,0.5);
    }

    /* --- EXAM UI --- */
    .exam-progress {
        display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;
    }
    .circular-timer {
        width: 50px; height: 50px; border-radius: 50%;
        background: conic-gradient(var(--primary) 100%, rgba(255,255,255,0.1) 0%);
        display: flex; align-items: center; justify-content: center;
        font-weight: 700; font-size: 0.8rem; position: relative;
    }
    .circular-timer::before {
        content:''; position: absolute; width: 42px; height: 42px; background: var(--bg-body); border-radius: 50%;
    }
    .timer-text { position: relative; z-index: 2; }

    .question-box { margin-bottom: 20px; min-height: 100px; }
    .q-badge { background: rgba(255,255,255,0.05); padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; display: inline-block;}
    .q-text { font-size: 1.2rem; font-weight: 600; line-height: 1.5; }

    .option {
        background: rgba(255,255,255,0.03);
        border: 1px solid rgba(255,255,255,0.05);
        padding: 16px; border-radius: 16px; margin-bottom: 10px;
        display: flex; align-items: center; cursor: pointer; transition: 0.2s;
    }
    .option:active { transform: scale(0.98); background: rgba(255,255,255,0.08); }
    .opt-char { 
        width: 36px; height: 36px; border-radius: 10px; background: rgba(255,255,255,0.1);
        display: flex; align-items: center; justify-content: center; font-weight: 700; margin-right: 15px; flex-shrink: 0;
    }
    
    .option.selected { border-color: var(--primary); background: rgba(6, 182, 212, 0.1); }
    .option.selected .opt-char { background: var(--primary); color: #000; }

    /* --- BOTTOM NAVIGATION (APP STYLE) --- */
    .bottom-nav {
        position: fixed; bottom: 0; left: 0; width: 100%;
        background: rgba(15, 23, 42, 0.9);
        backdrop-filter: blur(20px);
        border-top: 1px solid var(--glass-border);
        display: flex; justify-content: space-around;
        padding: 15px 0; z-index: 100;
        padding-bottom: max(15px, env(safe-area-inset-bottom));
    }
    .nav-item {
        color: var(--text-dim); text-align: center; font-size: 0.7rem; cursor: pointer; transition: 0.3s;
    }
    .nav-item svg { display: block; margin: 0 auto 4px auto; width: 24px; height: 24px; fill: currentColor; }
    .nav-item.active { color: var(--primary); transform: translateY(-2px); }
    .nav-item.active svg { filter: drop-shadow(0 0 8px var(--primary-glow)); }

    /* --- GRID MODAL (OPTIK FORM) --- */
    .modal-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.8); backdrop-filter: blur(5px);
        z-index: 200; display: flex; align-items: flex-end;
        visibility: hidden; opacity: 0; transition: 0.3s;
    }
    .modal-overlay.open { visibility: visible; opacity: 1; }
    
    .modal-content {
        background: #1e293b; width: 100%; border-radius: 24px 24px 0 0;
        padding: 25px; max-height: 80vh; overflow-y: auto;
        transform: translateY(100%); transition: 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
    }
    .modal-overlay.open .modal-content { transform: translateY(0); }

    .grid-questions {
        display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-top: 20px;
    }
    .grid-item {
        aspect-ratio: 1; background: rgba(255,255,255,0.05); border-radius: 8px;
        display: flex; align-items: center; justify-content: center; font-size: 0.9rem; font-weight: 600;
        cursor: pointer;
    }
    .grid-item.filled { background: var(--primary); color: #000; }
    .grid-item.current { border: 2px solid #fff; }

    /* --- ACTION BUTTONS --- */
    .btn-action {
        width: 100%; padding: 18px; border-radius: 18px; border: none;
        font-size: 1rem; font-weight: 700; color: #fff; cursor: pointer;
        display: flex; align-items: center; justify-content: center; gap: 10px;
        margin-top: 15px; transition: 0.3s;
    }
    .btn-glow {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        box-shadow: 0 10px 30px -5px var(--primary-glow);
    }
    .btn-glow:active { transform: scale(0.97); }

    /* --- STATS CHARTS --- */
    .chart-container { position: relative; height: 200px; width: 100%; margin-top: 15px; }
</style>
</head>
<body>

<div class="ambient-light"></div>

<div class="app-viewport">
    <header>
        <div class="brand">
            <h1>≈ûEKERKERIM</h1>
            <span>PLATINUM SECURITY</span>
        </div>
        <div class="user-pill" id="user-rank">
            ‚≠ê <span>√áaylak</span>
        </div>
    </header>

    <div id="view-dashboard" class="fade-in">
        <div class="card">
            <h2 style="margin-top:0;">Ho≈ügeldin Asker üëã</h2>
            <p style="color:var(--text-dim); font-size:0.9rem;">Bug√ºn g√ºvenlik kariyerin i√ßin ne yapacaksƒ±n?</p>
            
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-top:20px;">
                <div onclick="startExam('silahsƒ±z')" style="background:rgba(6,182,212,0.15); padding:15px; border-radius:16px; border:1px solid var(--primary); cursor:pointer; text-align:center;">
                    <div style="font-size:2rem; margin-bottom:5px;">üõ°Ô∏è</div>
                    <div style="font-weight:700; color:var(--primary);">Silahsƒ±z</div>
                    <div style="font-size:0.7rem; opacity:0.7;">100 Soru ‚Ä¢ 120 Dk</div>
                </div>
                <div onclick="startExam('silahlƒ±')" style="background:rgba(139,92,246,0.15); padding:15px; border-radius:16px; border:1px solid var(--secondary); cursor:pointer; text-align:center;">
                    <div style="font-size:2rem; margin-bottom:5px;">üî´</div>
                    <div style="font-weight:700; color:var(--secondary);">Silahlƒ±</div>
                    <div style="font-size:0.7rem; opacity:0.7;">125 Soru ‚Ä¢ 150 Dk</div>
                </div>
            </div>
        </div>

        <div class="card">
            <div style="display:flex; justify-content:space-between;">
                <h3>Son Performans</h3>
                <span style="font-size:0.8rem; color:var(--primary); cursor:pointer;" onclick="switchTab('stats')">Detaylar ‚Üí</span>
            </div>
            <canvas id="miniHistoryChart" height="100"></canvas>
        </div>
    </div>

    <div id="view-exam" class="hidden">
        <div class="exam-progress">
            <div style="display:flex; flex-direction:column;">
                <span style="font-size:0.7rem; color:var(--text-dim);">ƒ∞LERLEME</span>
                <span style="font-size:1.1rem; font-weight:700;" id="q-counter">1 / 100</span>
            </div>
            <div class="circular-timer" id="timer-circle">
                <span class="timer-text" id="timer-text">120</span>
            </div>
            <button onclick="toggleGrid()" style="background:none; border:1px solid rgba(255,255,255,0.2); color:#fff; padding:8px 12px; border-radius:10px; cursor:pointer;">
                ‚ò∞
            </button>
        </div>

        <div class="card">
            <div class="q-badge" id="q-category">TEMEL HUKUK</div>
            <div class="q-text" id="q-text">Soru y√ºkleniyor...</div>
        </div>

        <div id="options-container">
            </div>

        <div style="display:flex; gap:15px; margin-top:20px;">
            <button onclick="prevQuestion()" class="btn-action" style="background:#334155;">‚¨Ö √ñnceki</button>
            <button onclick="nextQuestion()" class="btn-action btn-glow">Sonraki ‚û°</button>
        </div>
    </div>

    <div id="view-stats" class="hidden fade-in">
        <h2 style="margin-bottom:20px;">Performans Analizi</h2>
        
        <div class="card">
            <h3>Konu Ba≈üarƒ±sƒ±</h3>
            <div class="chart-container">
                <canvas id="topicChart"></canvas>
            </div>
        </div>

        <div class="card">
            <h3>Sƒ±nav Ge√ßmi≈üi</h3>
            <ul id="history-list" style="list-style:none; padding:0; margin:0; font-size:0.9rem;">
                <li style="padding:10px 0; border-bottom:1px solid rgba(255,255,255,0.05); color:var(--text-dim);">Hen√ºz sƒ±nav verisi yok.</li>
            </ul>
        </div>
    </div>

    <div id="view-profile" class="hidden fade-in">
        <div style="text-align:center; margin-bottom:30px;">
            <div style="width:100px; height:100px; background:linear-gradient(135deg, var(--primary), var(--secondary)); border-radius:50%; margin:0 auto 15px auto; display:flex; align-items:center; justify-content:center; font-size:2.5rem; box-shadow:0 0 30px var(--primary-glow);">üòé</div>
            <h2 id="profile-name">ƒ∞simsiz Kahraman</h2>
            <p style="color:var(--text-dim);">Kenan Komutan'ƒ±n Se√ßkin √ñƒürencisi</p>
        </div>

        <div class="card">
            <label style="display:block; margin-bottom:10px; font-size:0.8rem; color:var(--text-dim);">ƒ∞SMƒ∞Nƒ∞Zƒ∞ G√úNCELLEYƒ∞N</label>
            <input type="text" id="name-input" placeholder="Adƒ±nƒ±zƒ± yazƒ±n..." style="width:100%; padding:15px; background:rgba(0,0,0,0.2); border:1px solid rgba(255,255,255,0.1); color:#fff; border-radius:12px;" oninput="updateName(this.value)">
        </div>

        <a href="https://www.instagram.com/kerimm.b/" target="_blank" class="btn-action" style="background: linear-gradient(45deg, #f09433, #bc1888);">
            Instagram'da Takip Et
        </a>
    </div>

</div>

<nav class="bottom-nav">
    <div class="nav-item active" onclick="switchTab('dashboard')" id="nav-dashboard">
        <svg viewBox="0 0 24 24"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
        Anasayfa
    </div>
    <div class="nav-item" onclick="switchTab('stats')" id="nav-stats">
        <svg viewBox="0 0 24 24"><path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"/></svg>
        Analiz
    </div>
    <div class="nav-item" onclick="switchTab('profile')" id="nav-profile">
        <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
        Profil
    </div>
</nav>

<div class="modal-overlay" id="grid-modal" onclick="if(event.target === this) toggleGrid()">
    <div class="modal-content">
        <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
            <h3>Soru Haritasƒ±</h3>
            <button onclick="finishExam()" style="background:var(--danger); border:none; color:#fff; padding:8px 15px; border-radius:8px; font-weight:bold;">SINAVI Bƒ∞Tƒ∞R</button>
        </div>
        <div class="grid-questions" id="grid-container">
            </div>
    </div>
</div>

<script>
    // --- DATABASE ---
    // Konu kategorileri ile geni≈ületilmi≈ü veri
    const categories = ["Hukuk", "Silah", "ƒ∞leti≈üim", "G√ºvenlik Tedbirleri", "ƒ∞lk Yardƒ±m"];
    const rawQuestions = [
        {c:"Hukuk", q:"5188 sayƒ±lƒ± Kanuna g√∂re √∂zel g√ºvenlik g√∂revlisi a≈üaƒüƒ±dakilerden hangisini yapamaz?",o:["Yakalama","Emanete alma","Kimlik sorma","ƒ∞fade alma","Zor kullanma"],a:3},
        {c:"Hukuk", q:"√ñzel g√ºvenlik g√∂revlisi kimlik sorma yetkisini hangi durumda kullanƒ±r?",o:["Her vatanda≈üa","≈û√ºpheli davranƒ±≈ü varsa","Sadece amirin emriyle","Toplu alanlarda","Mesai dƒ±≈üƒ±nda"],a:1},
        {c:"Silah", q:"A≈üaƒüƒ±dakilerden hangisi silah kullanma ≈üartlarƒ±ndan biridir?",o:["≈û√ºphelenmek","Amirin emri","Me≈üru savunma","Kimlik sormak","Caydƒ±rƒ±cƒ±lƒ±k"],a:2},
        {c:"G√ºvenlik Tedbirleri", q:"Kelep√ße takma ile ilgili hangisi doƒürudur?",o:["Her yakalanana takƒ±lƒ±r","Diren√ß g√∂sterene takƒ±lƒ±r","Kimliƒüi olmayana takƒ±lƒ±r","≈ûikayet√ßiye takƒ±lƒ±r","Tanƒ±ƒüa takƒ±lƒ±r"],a:1},
        {c:"Hukuk", q:"√ñzel g√ºvenlik g√∂revlisinin √ßalƒ±≈üma izni ka√ß yƒ±lda bir yenilenir?",o:["1","2","3","4","5"],a:4},
        {c:"ƒ∞leti≈üim", q:"A≈üaƒüƒ±dakilerden hangisi ileti≈üimde empatiyi ifade eder?",o:["Kar≈üƒ±yƒ± susturmak","Kar≈üƒ±yƒ± anlamaya √ßalƒ±≈ümak","Emir vermek","Y√ºksek sesle konu≈ümak","G√∂z temasƒ± kurmamak"],a:1},
        {c:"G√ºvenlik Tedbirleri", q:"Olay yerinde ilk yapƒ±lmasƒ± gereken nedir?",o:["Basƒ±na bilgi vermek","≈û√ºpheliyi d√∂vmek","Olay yerini koruma altƒ±na almak","Tanƒ±klarƒ± uzakla≈ütƒ±rmak","Delilleri toplamak"],a:2},
        {c:"Hukuk", q:"√ñzel g√ºvenlik g√∂revlisi hangi durumda √ºst aramasƒ± yapabilir?",o:["Her zaman","≈û√ºphe varsa","Kanunda belirtilen hallerde","Amirin isteƒüiyle","Vatanda≈ü isterse"],a:2},
        {c:"Silah", q:"Silahlƒ± √∂zel g√ºvenlik g√∂revlisi hangi durumda silahƒ±nƒ± kullanabilir?",o:["Keyfi kullanƒ±m","Me≈üru savunma","S√ºrekli ta≈üƒ±mak","G√∂rev bitiminde","Amirin isteƒüi"],a:1},
        {c:"ƒ∞lk Yardƒ±m", q:"Temel ya≈üam desteƒüi kime uygulanƒ±r?",o:["Her hastaya","Solunumu ve kalbi durmu≈ü ki≈üiye","Baygƒ±n ki≈üiye","Kanamasƒ± olana","≈ûoktaki ki≈üiye"],a:1},
        {c:"ƒ∞leti≈üim", q:"Etkili ileti≈üimde beden dili y√ºzde ka√ß etkilidir?",o:["%10","%30","%55","%70","%90"],a:2},
        {c:"Silah", q:"Fi≈üek yataƒüƒ±nda fi≈üek olup olmadƒ±ƒüƒ±nƒ± g√∂steren par√ßa hangisidir?",o:["Tetik","Horoz","ƒ∞ƒüne","Tƒ±rnak","Gez"],a:3}
    ];

    // --- STATE MANAGEMENT ---
    let appState = {
        currentView: 'dashboard',
        exam: {
            active: false,
            questions: [],
            answers: [], // Array of indices (null if unanswered)
            currentIndex: 0,
            timeRemaining: 0,
            timerId: null
        },
        user: {
            name: localStorage.getItem('userName') || '√ñGG Adayƒ±',
            history: JSON.parse(localStorage.getItem('userHistory')) || []
        }
    };

    // --- INITIALIZATION ---
    window.onload = () => {
        document.getElementById('name-input').value = appState.user.name;
        document.getElementById('profile-name').innerText = appState.user.name;
        updateRank();
        renderHistoryChart();
    };

    // --- NAVIGATION ---
    function switchTab(tabName) {
        // UI Updates
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        document.getElementById(`nav-${tabName}`).classList.add('active');
        
        // View Updates
        ['dashboard', 'exam', 'stats', 'profile'].forEach(v => {
            document.getElementById(`view-${v}`).classList.add('hidden');
        });
        document.getElementById(`view-${tabName}`).classList.remove('hidden');

        if(tabName === 'stats') renderStats();
    }

    // --- EXAM LOGIC ---
    function startExam(type) {
        // Generate Questions
        let count = type === 'silahsƒ±z' ? 100 : 125;
        let pool = [];
        while(pool.length < count) pool.push(...rawQuestions); // Duplicate for demo
        pool = pool.slice(0, count).sort(() => Math.random() - 0.5);

        appState.exam = {
            active: true,
            questions: pool,
            answers: new Array(count).fill(null),
            currentIndex: 0,
            timeRemaining: (type === 'silahsƒ±z' ? 120 : 150) * 60,
            timerId: setInterval(timerTick, 1000)
        };

        // Switch View
        document.getElementById('view-dashboard').classList.add('hidden');
        document.getElementById('view-exam').classList.remove('hidden');
        // Hide nav bar during exam to focus
        document.querySelector('.bottom-nav').classList.add('hidden');

        renderQuestion();
        updateGrid();
    }

    function timerTick() {
        appState.exam.timeRemaining--;
        const m = Math.floor(appState.exam.timeRemaining / 60);
        document.getElementById('timer-text').innerText = m;
        
        // Circular progress visual
        const total = 120 * 60; 
        const pct = (appState.exam.timeRemaining / total) * 100;
        document.getElementById('timer-circle').style.background = 
            `conic-gradient(var(--primary) ${pct}%, rgba(255,255,255,0.1) 0%)`;

        if(appState.exam.timeRemaining <= 0) finishExam();
    }

    function renderQuestion() {
        const q = appState.exam.questions[appState.exam.currentIndex];
        const userAns = appState.exam.answers[appState.exam.currentIndex];

        document.getElementById('q-counter').innerText = `${appState.exam.currentIndex + 1} / ${appState.exam.questions.length}`;
        document.getElementById('q-category').innerText = q.c.toUpperCase();
        document.getElementById('q-text').innerText = q.q;

        const container = document.getElementById('options-container');
        container.innerHTML = '';

        q.o.forEach((opt, idx) => {
            const div = document.createElement('div');
            div.className = `option ${userAns === idx ? 'selected' : ''}`;
            div.innerHTML = `<div class="opt-char">${String.fromCharCode(65+idx)}</div> ${opt}`;
            div.onclick = () => selectOption(idx);
            container.appendChild(div);
        });
    }

    function selectOption(idx) {
        appState.exam.answers[appState.exam.currentIndex] = idx;
        renderQuestion(); // Re-render to show selection
    }

    function nextQuestion() {
        if(appState.exam.currentIndex < appState.exam.questions.length - 1) {
            appState.exam.currentIndex++;
            renderQuestion();
        }
    }

    function prevQuestion() {
        if(appState.exam.currentIndex > 0) {
            appState.exam.currentIndex--;
            renderQuestion();
        }
    }

    // --- GRID / OPTIK FORM ---
    function toggleGrid() {
        const modal = document.getElementById('grid-modal');
        const isOpen = modal.classList.contains('open');
        
        if(!isOpen) {
            updateGrid();
            modal.classList.add('open');
        } else {
            modal.classList.remove('open');
        }
    }

    function updateGrid() {
        const container = document.getElementById('grid-container');
        container.innerHTML = '';
        appState.exam.answers.forEach((ans, i) => {
            const div = document.createElement('div');
            div.className = `grid-item ${ans !== null ? 'filled' : ''} ${i === appState.exam.currentIndex ? 'current' : ''}`;
            div.innerText = i + 1;
            div.onclick = () => {
                appState.exam.currentIndex = i;
                renderQuestion();
                toggleGrid(); // Close modal
            };
            container.appendChild(div);
        });
    }

    // --- RESULTS & LOGGING ---
    function finishExam() {
        clearInterval(appState.exam.timerId);
        document.getElementById('grid-modal').classList.remove('open');
        document.querySelector('.bottom-nav').classList.remove('hidden');

        // Calculate Score
        let correct = 0;
        appState.exam.questions.forEach((q, i) => {
            if(appState.exam.answers[i] === q.a) correct++;
        });

        // Save to History
        const result = {
            date: new Date().toLocaleDateString(),
            score: correct,
            total: appState.exam.questions.length
        };
        appState.user.history.push(result);
        localStorage.setItem('userHistory', JSON.stringify(appState.user.history));

        alert(`Sƒ±nav Bitti!\nPuanƒ±nƒ±z: ${correct} / ${appState.exam.questions.length}`);
        
        updateRank();
        switchTab('dashboard');
        renderHistoryChart(); // Refresh charts
    }

    // --- STATS & CHARTS ---
    function renderStats() {
        // Fake Topic Data for demo (Normally calculate from actual answers)
        const ctx = document.getElementById('topicChart').getContext('2d');
        
        // Destroy old chart if exists (simple check)
        if(window.myTopicChart) window.myTopicChart.destroy();

        window.myTopicChart = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: categories,
                datasets: [{
                    label: 'Ba≈üarƒ± Oranƒ± (%)',
                    data: [80, 65, 90, 55, 70], // Dynamic calculation should go here
                    backgroundColor: 'rgba(6, 182, 212, 0.2)',
                    borderColor: '#06b6d4',
                    borderWidth: 2,
                    pointBackgroundColor: '#fff'
                }]
            },
            options: {
                scales: {
                    r: {
                        grid: { color: 'rgba(255,255,255,0.1)' },
                        angleLines: { color: 'rgba(255,255,255,0.1)' },
                        suggestedMin: 0, suggestedMax: 100
                    }
                },
                plugins: { legend: { display: false } }
            }
        });

        // Fill History List
        const list = document.getElementById('history-list');
        list.innerHTML = '';
        [...appState.user.history].reverse().slice(0, 5).forEach(h => {
            list.innerHTML += `
                <li style="display:flex; justify-content:space-between; padding:15px 0; border-bottom:1px solid rgba(255,255,255,0.05);">
                    <span>${h.date}</span>
                    <span style="color:${h.score >= 60 ? 'var(--success)' : 'var(--danger)'}; font-weight:bold;">${h.score} Puan</span>
                </li>
            `;
        });
    }

    function renderHistoryChart() {
        const ctx = document.getElementById('miniHistoryChart').getContext('2d');
        if(window.myHistChart) window.myHistChart.destroy();

        const scores = appState.user.history.map(h => h.score);
        const labels = appState.user.history.map(h => h.date);

        window.myHistChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Puan',
                    data: scores.length ? scores : [0],
                    borderColor: '#8b5cf6',
                    tension: 0.4,
                    fill: true,
                    backgroundColor: 'rgba(139, 92, 246, 0.1)'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { x: { display: false }, y: { display: false } }
            }
        });
    }

    // --- USER PROFILE ---
    function updateName(val) {
        appState.user.name = val;
        localStorage.setItem('userName', val);
        document.getElementById('profile-name').innerText = val;
    }

    function updateRank() {
        const exams = appState.user.history.length;
        let rank = "√áaylak";
        if(exams > 5) rank = "Uzman";
        if(exams > 20) rank = "Ba≈ükomutan";
        document.getElementById('user-rank').innerHTML = `‚≠ê <span>${rank}</span>`;
    }

</script>
</body>
</html>
